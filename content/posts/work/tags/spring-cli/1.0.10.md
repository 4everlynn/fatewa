---
title: "Spring Cli 1.0.10 RELEASE Features"
date: 2022-03-24T17:30:10+08:00
tags: ["Spring cli"]
categories: ["java"]
draft: false
---

<div style="text-align: center;display: flex;flex-direction: column;justify-content:center;align-items:center;margin-bottom: 100px">
     <h1 style="font-weight: 300;text-shadow: 0 0 1px black;">Fatewa <span style="color: #faca30">Spring Cli Release log</span></h1>
     <h3 style="font-weight: 400;font-size: 18px;">Easy to build <b>Stronger</b><span style="margin-left: 8px;border: 1px solid black;padding: 2px 10px;background: #00b583;color: white;font-weight: 300;border-radius: 6px">restful API</span></h3>
     <span style="color: gray;font-size: 13px">
<focus-tag link>
Now at version 1.0.10
</focus-tag>
</span>
</div>

### Features
- [Service Component](#Service-Component)

### Service Component
我们已经知道在`Spirng Cli`项目中，通过`@Export`注解可以快速生成Restful风格的接口，并且在 `V1.0.5`版本中引入了`GeniusHooks`来扩展我们的业务需求。

<div style="margin-bottom: 45px;text-align: center" class="mermaid">
graph TB;
    r(Request&lt;T&gt;)
    c(Create Entity)
    u(Update Entity)
    d(Delete Entity)
    e(End)
    r --post--> hooks.beforeCreate --> c --> hooks.created --> e
    r --patch--> hooks.beforeUpdate --> u --> hooks.updated --> e
    r --delete--> hooks.beforeDelete --> d --> hooks.deleted --> e

</div>
<div style="argin-bottom: 45px;text-align: center" ><font size="1px">上图为GeniusHooks周期</font></div>

随着日常的使用，我们发现用户在一些场景中，使用`kernel`时需要对于某些类型进行格式化处理。考虑到这点，在这个版本我们增加了关于扩展插件的外部配置`SpeardPlugin`。

`SpreadPlugin`会对请求参数进行必要的格式化后，再交由后续步骤执行。
<div style="margin-bottom: 45px;text-align: center" class="mermaid">
graph TB;
    s(SpreadPlugin)
    r(Request&lt;T&gt;)
    e(End)
    s --> r
    r --post---> PostProcessing... ---> e
    r --patch---> PatchProcessing... ---> e
    r --get---> GetProcessing... ---> e
</div>


SpreadPlugin提供了两种方式进行插件的扩展
```java
// 全局扩展
SpreadPlugin.spread(TypePlugin<?,?> plus);

// 指定类型扩展
SpreadPlugin.assignSpread(Class<?> aClass,TypePlugin<?,?> plus);

```

在项目加载前，在你的配置中实例SpreadPlugin，如果你需要多个插件去工作，你只需要多次链式掉用spread()方法即可

简单的使用
```java
@Bean
SpreadPlugin spreadPlugin(){
    return new SpreadPlugin()
            .spread((TypePlugin<String, Integer>) item -> Integer.valueof(item))
            .spread((TypePlugin<String, Date>) item -> yourParseDateFoncation(item));
}

```
对于一些简单的类型处理，我们可能只需要一句lamda。

当然，在这里你也可以去进行一些复杂类型的转化，比如对于时间的转化或是在使用MybatisPlus时对于通用枚举的转化。

```java
@Bean
SpreadPlugin spreadPlugin(){
    return new SpreadPlugin()
            // 全局插件扩展
            .spread(new TypePlugin<String, Date>() {
                    @Override
                    public Date doTrans(String s) {
                        // 你的方法
                    }
                })
             // 指定类插件扩展
            .assignSpread(MyBean.class, (TypePlugin<String, MyBeanEnum>) s -> {
                    // 你的方法
                });
}
```


