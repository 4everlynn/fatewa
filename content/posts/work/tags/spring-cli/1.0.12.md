---
title: "Spring Cli 1.0.12 RELEASE Features"
date: 2022-08-22T10:32:10+08:00
tags: ["Spring cli"]
categories: ["java"]
draft: false
---

<div style="text-align: center;display: flex;flex-direction: column;justify-content:center;align-items:center;margin-bottom: 100px">
     <h1 style="font-weight: 300;text-shadow: 0 0 1px black;">Fatewa <span style="color: #faca30">Spring Cli Release log</span></h1>
     <h3 style="font-weight: 400;font-size: 18px;">Easy to build <b>Stronger</b><span style="margin-left: 8px;border: 1px solid black;padding: 2px 10px;background: #00b583;color: white;font-weight: 300;border-radius: 6px">restful API</span></h3>
     <span style="color: gray;font-size: 13px">
<focus-tag link>
Now at version 1.0.12
</focus-tag>
</span>
</div>

### Features
- [Service Component](#Service-Component)

### Service Component
我们已经知道在`Spirng Cli`项目中，通过`@Export`注解可以快速生成Restful风格的接口。

但是随着日常的使用，我们发现用户在一些场景中，使用`@Export`快速生成的查询接口时，需要根据特定字段进行排序。

考虑到这点，在这个版本中我们在`@Public`注解中增加了`order`功能。

当你有某个字段允许排序时，只需要在这个字段上使用`@Public`并设置`order = true`

```java
@Data
public class MyBean extends AncestorDomain implements Serializable {

    private String name;
    
    @Public(order = true)
    private Integer age;
}
```

那么在你使用`GET`查询的时候，你只需要在接口的参数条件中拼接上需要排序的字段即可，格式如下

```http request
    # 正序排序
    http://ip:port/api?q[age][order]=asc
```

```http request
    # 倒序排序
    http://ip:port/api?q[age][order]=desc
```

当然，你也可以同时对多个字段进行排序，只需要在对应字段上使用`@Public(order = true)`

```java
@Data
public class MyBean extends AncestorDomain implements Serializable {

    private String name;
    
    @Public(order = true)
    private Integer age;
    
    @Public(order = true)
    private String cardNumber;
    
    @Public(order = true)
    private String phone;
}
```

在查询时，你可以使用`[index]`去定义字段的权重，`例如：1~9，其中1的权重最高，9的权重最低`

```http request
http://ip:port/api?q[age][order]=asc&q[age][index]=1&q[age][phone]=desc&q[age][index]=2
```

当然除了排序外，我们也考虑到了用户在查询时，想要返回指定的字段，我们在`@Public`中也加入了`select`功能，只需要在字段上使用`@Public`并设置`select = true`

```java
@Data
public class MyBean extends AncestorDomain implements Serializable {

    @Public(select = true)
    private String name;
    
    @Public(select = true)
    private Integer age;
    
    private String cardNumber;
    
    @Public(select = true)
    private String phone;
}
```

那么在你使用`GET`查询的时候，你只需要在接口的参数条件中拼接上`select`条件，并且`select`的值是你需要的字段名，格式如下

```http request
    # 正序排序
    http://ip:port/api?select=name,age
```
这样在接口的response中就只会返回你指定的字段

(ps：当你使用`select`时，除被指定的字段会正常显示值外，其他字段的值都会以null返回，如果你想过滤掉这些null值，只需要在你的`application.yaml`中，找到`spring.jackson.default-property-inclusion`这项配置，并将它的值设置为`non_empty`即可)